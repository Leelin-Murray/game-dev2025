<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shape Dodger</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');

        body {
            background-color: #1a1a2e;
            color: #e4e4e4;
            font-family: 'Inter', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            flex-direction: column;
        }

        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #2e2e4a;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            max-width: 90%;
            width: 500px;
        }

        h1 {
            color: #8be9fd;
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        canvas {
            background-color: #162a3f;
            border: 2px solid #6272a4;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            cursor: none;
        }

        .controls {
            margin-top: 1.5rem;
            text-align: center;
            font-size: 1rem;
            color: #bd93f9;
        }
        
        #start-button, #restart-button {
            padding: 0.75rem 1.5rem;
            font-size: 1.25rem;
            font-weight: bold;
            color: #1a1a2e;
            background-color: #50fa7b;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(80, 250, 123, 0.4);
        }

        #start-button:hover, #restart-button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 6px 20px rgba(80, 250, 123, 0.6);
        }

        #restart-button {
            background-color: #ff5555;
            box-shadow: 0 4px 15px rgba(255, 85, 85, 0.4);
            display: none;
        }
        #restart-button:hover {
             box-shadow: 0 6-px 20px rgba(255, 85, 85, 0.6);
        }
        
        .score-board {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 480px;
            margin-top: 1rem;
            padding: 0.5rem 1rem;
            background-color: #282a36;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .score-board span {
            font-size: 1.2rem;
            font-weight: bold;
        }

        #current-score {
            color: #f1fa8c;
        }

        #high-score {
            color: #ff79c6;
        }
        
        #game-over-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(40, 42, 54, 0.9);
            padding: 2rem;
            border-radius: 10px;
            text-align: center;
            display: none;
            flex-direction: column;
            align-items: center;
            z-index: 10;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
        }

        #game-over-message h2 {
            font-size: 3rem;
            color: #ff5555;
            margin: 0;
        }

        #game-over-message p {
            font-size: 1.5rem;
            margin: 1rem 0;
            color: #f8f8f2;
        }
    </style>
</head>
<body>

    <div class="game-container">
        <h1>Shape Dodger</h1>
        <canvas id="gameCanvas" width="500" height="400"></canvas>
        <div class="score-board">
            <span>Score: <span id="current-score">0</span></span>
            <span>High Score: <span id="high-score">0</span></span>
        </div>
        <div class="controls">
            <button id="start-button">Start Game</button>
            <button id="restart-button">Restart Game</button>
        </div>
    </div>
    <div id="game-over-message">
        <h2>Game Over</h2>
        <p>Your Score: <span id="final-score">0</span></p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');
            const startButton = document.getElementById('start-button');
            const restartButton = document.getElementById('restart-button');
            const gameOverMessage = document.getElementById('game-over-message');
            const finalScoreSpan = document.getElementById('final-score');
            const currentScoreSpan = document.getElementById('current-score');
            const highScoreSpan = document.getElementById('high-score');
            
            // Player properties
            let player = {
                x: canvas.width / 2,
                y: canvas.height - 30,
                radius: 10,
                color: '#50fa7b'
            };

            // Game state variables
            let score = 0;
            let highScore = localStorage.getItem('highScore') || 0;
            highScoreSpan.textContent = highScore;
            let shapes = [];
            let isGameOver = false;
            let gameLoopInterval;
            let shapeSpawnInterval;
            
            const shapeTypes = ['circle', 'square', 'triangle'];
            const fastShapeTypes = ['star'];
            const colors = ['#ff5555', '#50fa7b', '#bd93f9', '#f1fa8c', '#ff79c6', '#8be9fd'];

            // Event listeners
            canvas.addEventListener('mousemove', movePlayer);
            canvas.addEventListener('touchmove', handleTouchMove, { passive: false });
            startButton.addEventListener('click', startGame);
            restartButton.addEventListener('click', restartGame);

            // Functions
            function movePlayer(e) {
                if (!isGameOver) {
                    const rect = canvas.getBoundingClientRect();
                    const scaleX = canvas.width / rect.width;
                    const mouseX = (e.clientX - rect.left) * scaleX;
                    player.x = Math.max(player.radius, Math.min(canvas.width - player.radius, mouseX));
                }
            }

            function handleTouchMove(e) {
                e.preventDefault();
                if (!isGameOver) {
                    const rect = canvas.getBoundingClientRect();
                    const scaleX = canvas.width / rect.width;
                    const touchX = (e.touches[0].clientX - rect.left) * scaleX;
                    player.x = Math.max(player.radius, Math.min(canvas.width - player.radius, touchX));
                }
            }
            
            function startGame() {
                startButton.style.display = 'none';
                isGameOver = false;
                score = 0;
                currentScoreSpan.textContent = score;
                shapes = [];
                gameOverMessage.style.display = 'none';
                
                gameLoopInterval = setInterval(updateGame, 20);
                shapeSpawnInterval = setInterval(spawnShape, 750);
            }
            
            function restartGame() {
                restartButton.style.display = 'none';
                startGame();
            }

            function spawnShape() {
                let type;
                let speed;

                // 20% chance to spawn a fast shape
                if (Math.random() < 0.2) {
                    type = fastShapeTypes[Math.floor(Math.random() * fastShapeTypes.length)];
                    speed = Math.random() * 3 + 4; // Fast shapes have a speed between 4 and 7
                } else {
                    type = shapeTypes[Math.floor(Math.random() * shapeTypes.length)];
                    speed = Math.random() * 2 + 1; // Normal shapes have a speed between 1 and 3
                }
                
                const size = Math.random() * 15 + 10; // Between 10 and 25
                const x = Math.random() * (canvas.width - size * 2) + size;
                const color = colors[Math.floor(Math.random() * colors.length)];
                
                shapes.push({
                    x: x,
                    y: -size,
                    size: size,
                    speed: speed,
                    color: color,
                    type: type
                });
            }

            function updateGame() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                drawPlayer();
                
                for (let i = 0; i < shapes.length; i++) {
                    const shape = shapes[i];
                    shape.y += shape.speed;
                    drawShape(shape);
                    
                    // Check for collision
                    if (isColliding(player, shape)) {
                        endGame();
                        return;
                    }
                    
                    // Remove shapes that are off-screen
                    if (shape.y > canvas.height + shape.size) {
                        shapes.splice(i, 1);
                        i--;
                        score++;
                        currentScoreSpan.textContent = score;
                    }
                }
            }

            function drawPlayer() {
                ctx.beginPath();
                ctx.arc(player.x, player.y, player.radius, 0, Math.PI * 2);
                ctx.fillStyle = player.color;
                ctx.fill();
                ctx.closePath();
            }

            function drawShape(shape) {
                ctx.fillStyle = shape.color;
                ctx.beginPath();
                switch (shape.type) {
                    case 'circle':
                        ctx.arc(shape.x, shape.y, shape.size, 0, Math.PI * 2);
                        ctx.fill();
                        break;
                    case 'square':
                        ctx.fillRect(shape.x - shape.size, shape.y - shape.size, shape.size * 2, shape.size * 2);
                        break;
                    case 'triangle':
                        ctx.moveTo(shape.x, shape.y - shape.size);
                        ctx.lineTo(shape.x - shape.size, shape.y + shape.size);
                        ctx.lineTo(shape.x + shape.size, shape.y + shape.size);
                        ctx.closePath();
                        ctx.fill();
                        break;
                    case 'star':
                        drawStar(ctx, shape.x, shape.y, shape.size, shape.size * 0.4);
                        ctx.fill();
                        break;
                }
            }
            
            function drawStar(context, cx, cy, outerRadius, innerRadius) {
                let rot = Math.PI / 2 * 3;
                let x = cx;
                let y = cy;
                const step = Math.PI / 5;

                context.moveTo(cx, cy - outerRadius);
                for (let i = 0; i < 5; i++) {
                    x = cx + Math.cos(rot) * outerRadius;
                    y = cy + Math.sin(rot) * outerRadius;
                    context.lineTo(x, y);
                    rot += step;

                    x = cx + Math.cos(rot) * innerRadius;
                    y = cy + Math.sin(rot) * innerRadius;
                    context.lineTo(x, y);
                    rot += step;
                }
                context.lineTo(cx, cy - outerRadius);
                context.closePath();
            }

            function isColliding(player, shape) {
                // Simplified collision detection for various shapes
                const distance = Math.sqrt((player.x - shape.x) ** 2 + (player.y - shape.y) ** 2);
                return distance < player.radius + shape.size;
            }

            function endGame() {
                isGameOver = true;
                clearInterval(gameLoopInterval);
                clearInterval(shapeSpawnInterval);
                
                if (score > highScore) {
                    highScore = score;
                    localStorage.setItem('highScore', highScore);
                    highScoreSpan.textContent = highScore;
                }
                
                finalScoreSpan.textContent = score;
                gameOverMessage.style.display = 'flex';
                restartButton.style.display = 'inline-block';
            }
        });
    </script>
</body>
</html>

